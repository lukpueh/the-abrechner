<head>
    <title>the-abrechner</title>
</head>

<body>
    <h1>The Urlaubs Abrechnungs Machine</h1>
</body>

<template name="home">

    <div>Who doesn't know this? What began as nice innocent holidays with beloved friends ends in distrust and even bloodshed
when it comes to partion of expenses. Well suffer no more!
The days of broken friendships are over. All thanks to the Urlaubs Abrechnungs Machine.
    </div>
    <form class="new-abrechner" method="post">
        <label>
            Title
            <input type="text" name="title" placeholder="Title">
        </label>
        <label>
            Description
            <textarea name="description" placeholder="Description"></textarea>
        </label>
        <input type="submit" value="Create new Urlaubs Abrechner" >
    </form>
</template>  

<template name="abrechner">
    <h2>Link</h2>
    You can access this page at {{urlFor 'abrechner'}}
    <h2>Title</h2>
    <div>{{title}}</div>
    <h2>Description</h2>
    <div>{{description}}</div>
    <h2>Who</h2>
    <form class="new-person" method="post">
        <label>
            Person
            <input type="text" name="person" placeholder="Person" >
        </label>
        <input type="submit" value="Add">
    </form>
        
    <ul>
    {{#each personsForAbrechnung}}
        <li>
            {{name}} <button class="delete-person">&times;</button>
        </li>
    {{/each}}
    </ul>

    <h2>What</h2>
    <form class="new-item" method="post">
        <label>
            Title
            <input type="text" name="item" placeholder="Item" >
        </label>
        <label>
            Amount
            <input type="text" name="amount" placeholder="Amount" >
        </label>
        <label>
            Who paid
            <select name="person">
            {{#each personsForAbrechnung}}
                <option value="{{_id}}">{{name}}</option>
            {{/each}}        
            </select>
        </label>
        <input type="submit" value="Add">
    </form>

    <ul>
    {{#each itemsForAbrechnung}}
        <li>
            {{title}} {{personNameById paidBy}} {{amount}}
            <button class="delete-item">&times;</button>
            <div>
            {{#each shares}}
                <div>
                    {{personNameById person}}<input class="pays-share" data-item-id="{{../_id}}" type="checkbox" name="pays" checked="{{pays}}">
                </div>
            {{/each}}
            </div>
        </li>      
    {{/each}}
    </ul>
<!--     <h2>Amounts per Item</h2>
        <div id="raphael-container"></div>
 -->
    <h2>Break Down</h2>
    <div>Total expenses: {{sum}}</div>
    {{#each breakDown}}
        <div>{{name}} paid {{paid}} and wants to pay {{pays}} which makes {{diff}}.</div>
    {{/each}}

    <button class="delete-abrechnung">&times;</button>

</template>  

